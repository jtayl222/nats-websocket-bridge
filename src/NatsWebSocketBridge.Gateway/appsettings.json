{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*",
  "Gateway": {
    "MaxMessageSize": 1048576,
    "MessageRateLimitPerSecond": 100,
    "OutgoingBufferSize": 1000,
    "AuthenticationTimeoutSeconds": 30,
    "PingIntervalSeconds": 30,
    "PingTimeoutSeconds": 10
  },
  "Nats": {
    "Url": "nats://localhost:4222",
    "ClientName": "NatsWebSocketBridge",
    "StreamName": "DEVICES",
    "UseJetStream": true,
    "ConnectionTimeoutSeconds": 10,
    "ReconnectDelayMs": 1000,
    "MaxReconnectAttempts": -1
  },
  "JetStream": {
    "Enabled": true,
    "Streams": [
      {
        "Name": "TELEMETRY",
        "Subjects": ["factory.sensor.*", "factory.sensor.>"],
        "Description": "Telemetry data from factory sensors",
        "Retention": "Limits",
        "Storage": "Memory",
        "MaxAge": "24h",
        "MaxMessages": 1000000,
        "MaxBytes": 1073741824,
        "MaxMessageSize": 1048576,
        "Replicas": 1,
        "Discard": "Old",
        "AllowDirect": true
      },
      {
        "Name": "EVENTS",
        "Subjects": ["factory.event.*", "factory.event.>"],
        "Description": "Factory events and state changes",
        "Retention": "Limits",
        "Storage": "File",
        "MaxAge": "7d",
        "MaxMessages": 5000000,
        "MaxBytes": 5368709120,
        "MaxMessageSize": 1048576,
        "Replicas": 1,
        "Discard": "Old",
        "AllowDirect": true
      },
      {
        "Name": "ALERTS",
        "Subjects": ["factory.alerts.*", "factory.alerts.>"],
        "Description": "Critical alerts and notifications",
        "Retention": "Limits",
        "Storage": "File",
        "MaxAge": "30d",
        "MaxMessages": 1000000,
        "MaxBytes": 1073741824,
        "MaxMessageSize": 1048576,
        "Replicas": 1,
        "Discard": "Old",
        "AllowDirect": true,
        "DenyDelete": true,
        "DenyPurge": true
      }
    ],
    "Consumers": [
      {
        "Name": "telemetry-processor",
        "StreamName": "TELEMETRY",
        "DurableName": "telemetry-processor",
        "FilterSubject": "factory.sensor.>",
        "DeliveryPolicy": "All",
        "AckPolicy": "Explicit",
        "AckWait": "30s",
        "MaxDeliver": 5,
        "MaxAckPending": 1000,
        "ReplayPolicy": "Instant",
        "Description": "Main telemetry processing consumer",
        "Type": "Pull"
      },
      {
        "Name": "event-handler",
        "StreamName": "EVENTS",
        "DurableName": "event-handler",
        "FilterSubject": "factory.event.>",
        "DeliveryPolicy": "New",
        "AckPolicy": "Explicit",
        "AckWait": "60s",
        "MaxDeliver": 10,
        "MaxAckPending": 500,
        "ReplayPolicy": "Instant",
        "Description": "Event processing consumer",
        "Type": "Pull"
      },
      {
        "Name": "alert-monitor",
        "StreamName": "ALERTS",
        "DurableName": "alert-monitor",
        "FilterSubject": "factory.alerts.>",
        "DeliveryPolicy": "All",
        "AckPolicy": "Explicit",
        "AckWait": "120s",
        "MaxDeliver": 20,
        "MaxAckPending": 100,
        "ReplayPolicy": "Instant",
        "Description": "Alert monitoring consumer",
        "Type": "Pull"
      }
    ],
    "PublishRetryPolicy": {
      "MaxRetries": 3,
      "InitialDelay": "100ms",
      "MaxDelay": "5s",
      "BackoffMultiplier": 2.0,
      "AddJitter": true
    },
    "DefaultConsumerOptions": {
      "AckWait": "30s",
      "MaxDeliver": 5,
      "MaxAckPending": 1000,
      "DefaultBatchSize": 100,
      "FetchTimeout": "5s"
    }
  }
}
